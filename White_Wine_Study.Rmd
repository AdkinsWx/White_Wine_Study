---
title: "White wine study"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 


Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).



========================================================
  
 
```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message = FALSE)
# Load all of the packages that you end up using in your analysis in this code
# chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk. This
# prevents the code from displaying in the knitted HTML output. You should set
# echo=FALSE for all code chunks in your file, unless it makes sense for your
# report to show the code that generated a particular plot.

# The other parameters for "message" and "warning" should also be set to FALSE
# for other code chunks once you have verified that each plot comes out as you
# want it to. This will clean up the flow of your report.

library(ggplot2)
library(dplyr)
library(GGally)
library(gridExtra)
library(diptest)
library(knitr)
```

```{r echo=FALSE, Load_the_Data}
# Load the Data
winedf = read.csv('wineQualityWhites.csv')
```

> This tidy data set contains 4,898 red wines with 11 variables 
on the chemical properties of the wine. 
At least 3 wine experts rated the quality of each wine, providing a rating 
between 0 (very bad) and 10 (very excellent).
Here we will explore which chemical properties influence the taste of white wines.

# Univariate Plots Section


> First let's take a look at some of the variables
and see what the values look like'

```{r echo=FALSE, Univariate_Plots}
names(winedf)
summary(winedf)
#X is not a useable variable so we will remove below
wines <- subset(winedf, select = -X)
head(wines)
```
> After removing the unneeded X variable, we can see
eleven attributes that may contribute to the taste
and quality rating of the wine.

```{r echo=FALSE, Univariate_Plots_1}
summary(wines$quality)
ggplot(wines, aes(quality))+
  geom_histogram(binwidth = 1)
```

> Here we can see that the quality ranges from
3 to 9 with a mean rating of 5.878.
Next we'll plot an analyze resiudal sugars. This is 
the amount of sugar remaining after fermentation stops, 
it's rare to find wines with less than 1 gram/liter 
and wines with greater than 45 grams/liter are considered sweet 
so we shouldn't expect many data points below 1.

```{r echo=FALSE, Univariate_Plots_2}
summary(wines$residual.sugar)
ggplot(wines, aes(residual.sugar))+
  geom_histogram(bins = 50)
```

> After plotting Residual Sugar within the wines we
can see that it is highly skewed to the left. We can also see that
we have no data points over 45 gram/liter ie sweet wines. However, it does appear that
we have quite a few data points near 1 gram/liter. Given this we'll next 
we'll plot just the bottom 95% to get a better grasp
of the distribution of residual sugars.

```{r echo=FALSE, Univariate_Plots_3}
summary(subset(wines$residual.sugar,
               wines$residual.sugar <
                 quantile(wines$residual.sugar,
                          .95)))
ggplot(wines, aes(residual.sugar))+
  geom_histogram(binwidth = .1)+
  xlim(0, quantile(wines$residual.sugar, .95))+
  xlab("residual.sugar (Lower 95%)")+
  geom_vline(xintercept = mean(wines$residual.sugar), color = 'blue')+
  geom_vline(xintercept = median(wines$residual.sugar), color = 'red')+
  geom_vline(xintercept = 1, color = 'green')
```

> After plotting the lower 95% we still have a skewed distribution.
But this graph does reveal more information. First, the vertical green line denotes 1 gram/liter of sugar.
Observing the the around this line reveals that we have many wines that according to the citations would be considered rare, given their sugar profile below 1 gram/liter. Previously, I found that Red wines in a similiar study 
had an average residual sugar count around 2.5 gram/liter and only one data point below 1 gram/liter. However, the white wine sugar profile is very different. As pointed out we have a noteworthy amount of white wines below 1 gram/liter, more than red wines, and an average of 5.77 gram/liter, higher than the red wines. This gives a distribution much wider and perhaps more complex in determing quality than the red wines.
Another thing to consider is the amount of observations. We have almost 5000 white wine observations vs the 1600 for the red wines. This is more than twice the amount of red wine observations and may have something to contribute towards the wider distribution.

> Let's progress to another variable, alcohol content. Again, because of the amount of observations we may see a wider distribution than previously observed in the last study.


```{r echo=FALSE, Univariate_Plots_4}
summary(wines$alcohol)
ggplot(wines, aes(alcohol))+
  geom_histogram(binwidth = 0.1)+
  geom_vline(xintercept = mean(wines$alcohol), color ="blue")+
  geom_vline(xintercept = median(wines$alcohol), color='red')
```

> After plotting alcohol content we do see a more normalized distribution with a mean around 10.51%.
Now that we hyper focused on two variables lets create mutiple plots of the remaining variables and try to uncover any remaining anomolies worth exploring.

```{r echo=FALSE, Univariate_Plots_5}
p1 <- qplot(wines$fixed.acidity)
p2 <- qplot(wines$volatile.acidity)
p3 <- qplot(wines$citric.acid)
p4 <- qplot(wines$chlorides)
p5 <- qplot(wines$free.sulfur.dioxide)
p6 <- qplot(wines$total.sulfur.dioxide)
p7 <- qplot(wines$density)
p8 <- qplot(wines$pH)
p9 <- qplot(wines$sulphates)

grid.arrange(p1, p2, p3, p4, p5, p6, p7, p8, p9, ncol = 3)
```

> After analyzing these plots most look well-behaved, ie normal distributions, aside from the sulphates. It appears that it may be slightly bimodal and is worth clarifying. We'll use RStudio's Hartigans dip.test function to test for unimodality/multimodality

```{r echo=FALSE, Univariate_Plots_6}
qplot(wines$sulphates, binwidth= .01)
dip.test(wines$sulphates)
```
> After running the bimodal test we do return a D value of 0.0245. Note that any value less than 0.05 suggest significant bimodality.
This could suggest that we have two different populations of white wines with different average sulphate profiles. Using the information from the data citation material we can see that there are several different grapes used to create the white wines. Given this new observation we should pay careful attention when determing if sulphates determine the wine's quality. 
